$(function(){$(window).resize(function(){resizeBg()});$(window).bind("load",function(){resizeBg()})});function resizeBg(){var bgImg=$("#bg");var imgwidth=bgImg.width();var imgheight=bgImg.height();var winwidth=$(window).width();var winheight=$(window).height();var widthratio=winwidth/imgwidth;var heightratio=winheight/imgheight;var widthdiff=heightratio*imgwidth;var heightdiff=widthratio*imgheight;if(heightdiff>winheight){bgImg.css({width:winwidth+"px",height:heightdiff+"px"})}else{bgImg.css({width:widthdiff+"px",height:winheight+"px"})}}if(typeof JSON!=="object"){JSON={}}(function(){function f(n){return n<10?"0"+n:n}if(typeof Date.prototype.toJSON!=="function"){Date.prototype.toJSON=function(key){return isFinite(this.valueOf())?this.getUTCFullYear()+"-"+f(this.getUTCMonth()+1)+"-"+f(this.getUTCDate())+"T"+f(this.getUTCHours())+":"+f(this.getUTCMinutes())+":"+f(this.getUTCSeconds())+"Z":null};String.prototype.toJSON=Number.prototype.toJSON=Boolean.prototype.toJSON=function(key){return this.valueOf()}}var cx=/[\u0000\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,escapable=/[\\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,gap,indent,meta={"\b":"\\b","\t":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"},rep;function quote(string){escapable.lastIndex=0;return escapable.test(string)?'"'+string.replace(escapable,function(a){var c=meta[a];return typeof c==="string"?c:"\\u"+("0000"+a.charCodeAt(0).toString(16)).slice(-4)})+'"':'"'+string+'"'}function str(key,holder){var i,k,v,length,mind=gap,partial,value=holder[key];if(value&&typeof value==="object"&&typeof value.toJSON==="function"){value=value.toJSON(key)}if(typeof rep==="function"){value=rep.call(holder,key,value)}switch(typeof value){case"string":return quote(value);case"number":return isFinite(value)?String(value):"null";case"boolean":case"null":return String(value);case"object":if(!value){return"null"}gap+=indent;partial=[];if(Object.prototype.toString.apply(value)==="[object Array]"){length=value.length;for(i=0;i<length;i+=1){partial[i]=str(i,value)||"null"}v=partial.length===0?"[]":gap?"[\n"+gap+partial.join(",\n"+gap)+"\n"+mind+"]":"["+partial.join(",")+"]";gap=mind;return v}if(rep&&typeof rep==="object"){length=rep.length;for(i=0;i<length;i+=1){if(typeof rep[i]==="string"){k=rep[i];v=str(k,value);if(v){partial.push(quote(k)+(gap?": ":":")+v)}}}}else{for(k in value){if(Object.prototype.hasOwnProperty.call(value,k)){v=str(k,value);if(v){partial.push(quote(k)+(gap?": ":":")+v)}}}}v=partial.length===0?"{}":gap?"{\n"+gap+partial.join(",\n"+gap)+"\n"+mind+"}":"{"+partial.join(",")+"}";gap=mind;return v}}if(typeof JSON.stringify!=="function"){JSON.stringify=function(value,replacer,space){var i;gap="";indent="";if(typeof space==="number"){for(i=0;i<space;i+=1){indent+=" "}}else{if(typeof space==="string"){indent=space}}rep=replacer;if(replacer&&typeof replacer!=="function"&&(typeof replacer!=="object"||typeof replacer.length!=="number")){throw new Error("JSON.stringify")}return str("",{"":value})}}if(typeof JSON.parse!=="function"){JSON.parse=function(text,reviver){var j;function walk(holder,key){var k,v,value=holder[key];if(value&&typeof value==="object"){for(k in value){if(Object.prototype.hasOwnProperty.call(value,k)){v=walk(value,k);if(v!==undefined){value[k]=v}else{delete value[k]}}}}return reviver.call(holder,key,value)}text=String(text);cx.lastIndex=0;if(cx.test(text)){text=text.replace(cx,function(a){return"\\u"+("0000"+a.charCodeAt(0).toString(16)).slice(-4)})}if(/^[\],:{}\s]*$/.test(text.replace(/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,"@").replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,"]").replace(/(?:^|:|,)(?:\s*\[)+/g,""))){j=eval("("+text+")");return typeof reviver==="function"?walk({"":j},""):j}throw new SyntaxError("JSON.parse")}}}());$(function(){$("a.x2-link").draggable({revert:"invalid",helper:"clone",revertDuration:200,appendTo:"body",iframeFix:true});if(window.fullscreen){$("#page-body").addClass("no-widgets")}var $header=$("#header .width-constraint").first();var $moreMenuLi=$("#main-menu ul").parent();var $moreMenu=$("#main-menu ul");var $userSubMenu=$("#user-menu ul");var $pageBodyDiv=$("#page-body");var $pageWidthDivs=$("div.width-constraint");var $contentDiv=$("div#content");var pageMode=-1;var newPageMode=0;var historyMode=-1;var newHistoryMode=0;$moreMenu.children().insertBefore($moreMenuLi);var $menuItems=$("#main-menu > li").not("#more-menu");var currentVisibleItems=$menuItems.length;var menuItemCutoffs=new Array($menuItems.length);for(i=0;i<menuItemCutoffs.length;i++){if(i==0){menuItemCutoffs[i]=$($menuItems[i]).outerWidth()+$("#user-menu").outerWidth()+$("#more-menu").outerWidth()+40}else{menuItemCutoffs[i]=$($menuItems[i]).outerWidth()+menuItemCutoffs[i-1]}}$(window).resize(function(){var windowWidth=$(window).width();var contentWidth=$contentDiv.width();if(windowWidth<=1040){newPageMode=0}else{if(windowWidth>=1040&&window.enableFullWidth){newPageMode=2}else{newPageMode=1}}if(pageMode!=newPageMode){pageMode=newPageMode;if(pageMode==0){$pageBodyDiv.addClass("no-widgets")}else{if(!window.fullscreen){$pageBodyDiv.removeClass("no-widgets")}}}if(contentWidth<940){newHistoryMode=0}else{newHistoryMode=1}if(historyMode!=newHistoryMode){historyMode=newHistoryMode;if(historyMode==1){$("#main-column, .history").addClass("half-width")}else{$("#main-column, .history").removeClass("half-width")}}var visibleItems=0;for(i=0;i<menuItemCutoffs.length;i++){if(menuItemCutoffs[i]+70<$header.outerWidth()){visibleItems=i+1}else{break}}if(visibleItems<1){visibleItems=1}if(visibleItems>currentVisibleItems){for(i=0;i<visibleItems-currentVisibleItems;i++){$moreMenu.children().first().insertBefore($moreMenuLi)}currentVisibleItems=$("#main-menu > li").not("#more-menu").length}else{if(visibleItems<currentVisibleItems){for(i=$menuItems.length-1;i>=visibleItems;i--){$($menuItems[i]).prependTo("#main-menu ul")}currentVisibleItems=$("#main-menu > li").not("#more-menu").length}}if($moreMenu.children().length==0){$moreMenuLi.hide()}else{$moreMenuLi.show()}});$(".dropdown span").mousedown(function(){var $dropdown=$(this).siblings("ul");$dropdown.toggleClass("open");$(".dropdown ul").not($dropdown).removeClass("open");return false});$("#widget-button").click(function(){if($("#widget-menu li").length!=0){$("#widget-menu").toggle()}return false});$(document).bind("click",function(e){var $clicked=$(e.target);if(!$clicked.parents().is(".dropdown")){$(".dropdown ul").removeClass("open")}if(!$clicked.is("#widget-button")){$("#widget-menu").hide()}});$(".yiiLog").draggable({handle:"tr:first th"}).height(400).offset({top:200,left:80}).find("tr:first").dblclick(function(){var x=$(this).closest(".yiiLog");if(x.height()<50){x.height(400)}else{x.height(23)}});$(".yiiTranslationList").draggable({handle:"td,th"}).offset({top:300,left:0});$("#fullscreen-button").click(function(){$.ajax({url:yii.scriptUrl+"/site/fullscreen",type:"GET",data:"fs="+(window.fullscreen?"0":"1")});window.fullscreen=!window.fullscreen;if(window.fullscreen){$pageBodyDiv.addClass("no-widgets")}else{if(pageMode!=0){$pageBodyDiv.removeClass("no-widgets")}}$(window).resize()});var pageTitle=$(".page-title.fixed").first();var pageTitleWidth=pageTitle.next();var mainColumn=pageTitle.parent();if(pageTitle.length){$(window).resize(function(e){pageTitle.width(pageTitleWidth.width()-48);mainColumn.css("margin-top",(pageTitle.height()+6)+"px")})}$(window).resize()});function togglePortletVisible(portlet,response){portlet.children(".portlet-content").toggle("blind");var text;if(response==true){var text="[&ndash;]"}else{var text="[+]"}portlet.find(".portlet-minimize a").html(text)}function mediaFileUpload(form,fileField,action_url,remove_url){var iframe=document.createElement("iframe");iframe.setAttribute("id","upload_iframe");iframe.setAttribute("name","upload_iframe");iframe.setAttribute("width","0");iframe.setAttribute("height","0");iframe.setAttribute("border","0");iframe.setAttribute("style","width: 0; height: 0; border: none;");form.parentNode.appendChild(iframe);window.frames.upload_iframe.name="upload_iframe";iframeId=document.getElementById("upload_iframe");var eventHandler=function(){if(iframeId.detachEvent){iframeId.detachEvent("onload",eventHandler)}else{iframeId.removeEventListener("load",eventHandler,false)}if(iframeId.contentDocument){var content=iframeId.contentDocument.body.innerHTML}else{if(iframeId.contentWindow){var content=iframeId.contentWindow.document.body.innerHTML}else{if(iframeId.document){var content=iframeId.document.body.innerHTML}}}var response=$.parseJSON(content);if(response.status=="success"){var file=$("<input>",{type:"hidden",name:"AttachmentFiles[id][]","class":"AttachmentFiles",value:response.id});var temp=$("<input>",{type:"hidden",name:"AttachmentFiles[temp][]",value:true});var parent=fileField.parent();parent.find(".temp-file-id").val(response.id);parent.find(".filename").html(response.name);var chooseFileButtonCenter=parseInt($(".x2-file-wrapper").children(".x2-button").prop("clientHeight"),10)/2;var halfSpanHeight=parseInt($(".x2-file-wrapper").children(".filename").height(),10)/2;var spanTop=chooseFileButtonCenter-halfSpanHeight;$(".x2-file-wrapper").children(".filename").css("top",spanTop+"px");$("#choose-file-saving-icon").animate({opacity:0});parent.find(".filename").html(response.name).animate({opacity:1});form.removeAttribute("target");form.removeAttribute("enctype");form.removeAttribute("encoding");form.setAttribute("action",$(form).data("oldAction"))}else{if(response.status=="notsent"){$("#choose-file-saving-icon").animate({opacity:0});form.removeAttribute("target");form.removeAttribute("enctype");form.removeAttribute("encoding");form.setAttribute("action",$(form).data("oldAction"))}else{fileField.parent().find(".error").html(response.message);fileField.val("")}}setTimeout("iframeId.parentNode.removeChild(iframeId)",250)};$(form).data("oldAction",$(form).attr("action"));if(iframeId.addEventListener){iframeId.addEventListener("load",eventHandler,true)}if(iframeId.attachEvent){iframeId.attachEvent("onload",eventHandler)}form.setAttribute("target","upload_iframe");form.setAttribute("action",action_url);form.setAttribute("method","post");form.setAttribute("enctype","multipart/form-data");form.setAttribute("encoding","multipart/form-data");$(".x2-file-wrapper").children(".x2-button").animate({opacity:0});$("#choose-file-saving-icon").animate({opacity:1});form.submit()}var illegal_ext=["exe","bat","dmg","js","jar","swf","php","pl","cgi","htaccess","py"];function mediaCheckName(el){var name=el.value;var ar_name=name.split(".");ar_ext=ar_name[ar_name.length-1].toLowerCase();var re=1;for(i in illegal_ext){if(illegal_ext[i]==ar_ext){re=0;break}}if(re==1){return true}else{alert(filenameError.replace("{X}",ar_ext));return false}}$(function(){$("form").submit(function(){var tempFileId=$(".x2-file-wrapper").children(".temp-file-id");if(tempFileId.val()==""){alert("Please choose a file.");return false}})});function mediaSubmit(){var tempfileid=$(".x2-file-wrapper").children(".temp-file-id");if(tempfileid.val()!=""){tempfileid.form.submit()}else{alert("Please choose a file.")}}function showAssociationAutoComplete(associationType){var name=$(associationType).val();if(name!="bg"&&name!="none"){$("#Media_associationId").val("");$(".ui-autocomplete-input").css("display","none");$("#"+name+"-auto-select").css("display","inline-block")}}function toggleUserMedia(userMedia,showhide,response){userMedia.toggle("blind");var text;if(response==true){var text="[&ndash;]"}else{var text="[+]"}showhide.html(text)}window.Modernizr=function(a,b,c){function z(a){j.cssText=a}function A(a,b){return z(prefixes.join(a+";")+(b||""))}function B(a,b){return typeof a===b}function C(a,b){return !!~(""+a).indexOf(b)}function D(a,b){for(var d in a){var e=a[d];if(!C(e,"-")&&j[e]!==c){return b=="pfx"?e:!0}}return !1}function E(a,b,d){for(var e in a){var f=b[a[e]];if(f!==c){return d===!1?a[e]:B(f,"function")?f.bind(d||b):f}}return !1}function F(a,b,c){var d=a.charAt(0).toUpperCase()+a.slice(1),e=(a+" "+n.join(d+" ")+d).split(" ");return B(b,"string")||B(b,"undefined")?D(e,b):(e=(a+" "+o.join(d+" ")+d).split(" "),E(e,b,c))}var d="2.6.1",e={},f=!0,g=b.documentElement,h="modernizr",i=b.createElement(h),j=i.style,k,l={}.toString,m="Webkit Moz O ms",n=m.split(" "),o=m.toLowerCase().split(" "),p={},q={},r={},s=[],t=s.slice,u,v=function(a,c,d,e){var f,i,j,k=b.createElement("div"),l=b.body,m=l?l:b.createElement("body");if(parseInt(d,10)){while(d--){j=b.createElement("div"),j.id=e?e[d]:h+(d+1),k.appendChild(j)}}return f=["&#173;",'<style id="s',h,'">',a,"</style>"].join(""),k.id=h,(l?k:m).innerHTML+=f,m.appendChild(k),l||(m.style.background="",g.appendChild(m)),i=c(k,a),l?k.parentNode.removeChild(k):m.parentNode.removeChild(m),!!i},w=function(){function d(d,e){e=e||b.createElement(a[d]||"div"),d="on"+d;var f=d in e;return f||(e.setAttribute||(e=b.createElement("div")),e.setAttribute&&e.removeAttribute&&(e.setAttribute(d,""),f=B(e[d],"function"),B(e[d],"undefined")||(e[d]=c),e.removeAttribute(d))),e=null,f}var a={select:"input",change:"input",submit:"form",reset:"form",error:"img",load:"img",abort:"img"};return d}(),x={}.hasOwnProperty,y;!B(x,"undefined")&&!B(x.call,"undefined")?y=function(a,b){return x.call(a,b)}:y=function(a,b){return b in a&&B(a.constructor.prototype[b],"undefined")},Function.prototype.bind||(Function.prototype.bind=function(b){var c=this;if(typeof c!="function"){throw new TypeError}var d=t.call(arguments,1),e=function(){if(this instanceof e){var a=function(){};a.prototype=c.prototype;var f=new a,g=c.apply(f,d.concat(t.call(arguments)));return Object(g)===g?g:f}return c.apply(b,d.concat(t.call(arguments)))};return e}),p.hashchange=function(){return w("hashchange",a)&&(b.documentMode===c||b.documentMode>7)},p.websockets=function(){return"WebSocket" in a||"MozWebSocket" in a},p.csstransforms=function(){return !!F("transform")},p.localstorage=function(){try{return localStorage.setItem(h,h),localStorage.removeItem(h),!0}catch(a){return !1}},p.webworkers=function(){return !!a.Worker},p.applicationcache=function(){return !!a.applicationCache};for(var G in p){y(p,G)&&(u=G.toLowerCase(),e[u]=p[G](),s.push((e[u]?"":"no-")+u))}return e.addTest=function(a,b){if(typeof a=="object"){for(var d in a){y(a,d)&&e.addTest(d,a[d])}}else{a=a.toLowerCase();if(e[a]!==c){return e}b=typeof b=="function"?b():b,f&&(g.className+=" "+(b?"":"no-")+a),e[a]=b}return e},z(""),i=k=null,e._version=d,e._domPrefixes=o,e._cssomPrefixes=n,e.hasEvent=w,e.testProp=function(a){return D([a])},e.testAllProps=F,e.testStyles=v,g.className=g.className.replace(/(^|\s)no-js(\s|$)/,"$1$2")+(f?" js "+s.join(" "):""),e}(this,this.document),Modernizr.testStyles("#modernizr{background-size:cover}",function(a){var b=window.getComputedStyle?window.getComputedStyle(a,null):a.currentStyle;Modernizr.addTest("bgsizecover",b.backgroundSize=="cover")});var x2CreateContactDialog=null;var x2CreateAccountDialog=null;var x2CreateOpportunityDialog=null;var x2CreateCaseDialog=null;$.fn.initCreateAccountDialog=function(){if(x2CreateAccountDialog!=null){return}x2CreateAccountDialog=$("<div></div>",{id:"x2-create-action-dialog"});x2CreateAccountDialog.dialog({title:"Create Account",autoOpen:false,resizable:true,width:"650px",show:"fade",hide:"fade"});x2CreateAccountDialog.data("inactive",true);$(this).click(function(){if($(this).data("createAccountUrl")!=undefined){if(x2CreateAccountDialog.data("inactive")){$.post($(this).data("createAccountUrl"),{x2ajax:true},function(response){x2CreateAccountDialog.append(response);x2CreateAccountDialog.dialog("open");x2CreateAccountDialog.data("inactive",false);x2CreateAccountDialog.find(".formSectionHide").remove();submit=x2CreateAccountDialog.find('input[type="submit"]');form=x2CreateAccountDialog.find("form");$(submit).click(function(){var formdata=form.serializeArray();var x2ajax={};x2ajax.name="x2ajax";x2ajax.value="1";formdata.push(x2ajax);$.post($(".create-account").data("createAccountUrl"),formdata,function(response){response=$.parseJSON(response);if(response.status=="success"){$("#Contacts_company").val(response.name);$("#Contacts_company_id").val(response.id);x2CreateAccountDialog.dialog("close")}});return false});$("#Accounts_phone").val($("div.formInputBox #Contacts_phone").val());$("#Accounts_website").val($("div.formInputBox #Contacts_website").val());$("#Accounts_assignedTo_assignedToDropdown").val($("#Contacts_assignedTo_assignedToDropdown").val())})}else{x2CreateAccountDialog.dialog("open")}}});return $(this)};$.fn.initCreateContactDialog=function(createContactUrl,modelName,modelId,accountName,assignedTo,phone,website,tooltip){$("#create-contact").data("createContactUrl",createContactUrl);$("#create-contact").data("modelName",modelName);$("#create-contact").data("modelId",modelId);$("#create-contact").data("account-name",accountName);$("#create-contact").data("assigned-to",assignedTo);$("#create-contact").data("phone",phone);$("#create-contact").data("website",website);$("#create-contact").qtip({content:tooltip});if(x2CreateContactDialog!=null){return}x2CreateContactDialog=$("<div></div>",{id:"x2-create-contact-dialog"});x2CreateContactDialog.dialog({title:"Create Contact",autoOpen:false,resizable:true,width:"650px",show:"fade",hide:"fade"});x2CreateContactDialog.data("inactive",true);$(this).click(function(){if($(this).data("createContactUrl")!=undefined){if(x2CreateContactDialog.data("inactive")){$.post($(this).data("createContactUrl"),{x2ajax:true},function(response){x2CreateContactDialog.append(response);x2CreateContactDialog.dialog("open");x2CreateContactDialog.data("inactive",false);x2CreateContactDialog.find(".formSectionHide").remove();x2CreateContactDialog.find(".create-account").remove();submit=x2CreateContactDialog.find('input[type="submit"]');form=x2CreateContactDialog.find("form");$(submit).click(function(){return x2CreateContactDialogHandleSubmit(form)});if($("#create-contact").data("account-name")!=undefined){$("#Contacts_company").val($("#create-contact").data("account-name"))}if($("#create-contact").data("assigned-to")!=undefined){$("#Contacts_assignedTo_assignedToDropdown").val($("#create-contact").data("assigned-to"))}if($("#create-contact").data("phone")!=undefined){$("div.formInputBox #Contacts_phone").val($("#create-contact").data("phone"))}if($("#create-contact").data("website")!=undefined){$("#Contacts_website").val($("#create-contact").data("website"))}})}else{x2CreateContactDialog.dialog("open")}}});return $(this)};function x2CreateContactDialogHandleSubmit(form){var formdata=form.serializeArray();var x2ajax={};x2ajax.name="x2ajax";x2ajax.value="1";var modelName={};modelName.name="ModelName";modelName.value=$("#create-contact").data("modelName");var modelId={};modelId.name="ModelId";modelId.value=$("#create-contact").data("modelId");formdata.push(x2ajax);formdata.push(modelName);formdata.push(modelId);$.post($("#create-contact").data("createContactUrl"),formdata,function(response){response=$.parseJSON(response);if(response.status=="success"){if($("#opportunities-grid").length==1){$.fn.yiiGridView.update("opportunities-grid")}x2CreateContactDialog.dialog("close");x2CreateContactDialog.empty();$("body").off("click","#Contact_assignedTo_groupCheckbox");x2CreateContactDialog.data("inactive",true);if(response.primaryAccountLink!=undefined){if(response.primaryAccountLink!=""){$("#Opportunity_accountName_field div.formInputBox").html(response.primaryAccountLink);showRelationships=false}}if(response.newPhone!=undefined){if(response.newPhone!=""){$("#Accounts_phone_field div.formInputBox").html(response.newPhone)}}if(response.newWebsite!=undefined){if(response.newWebsite!=""){$("#Accounts_website_field div.formInputBox").html(response.newWebsite)}}if($("#relationships-form").is(":hidden")){toggleRelationshipsForm()}if(response.name!=undefined&&response.id!=undefined&&$("#Services_contactId").length==1&&$("#Services_contactId_id").length==1){$("#Services_contactId").val(response.name);$("#Services_contactId_id").val(response.id)}}else{if(response.status=="userError"){if(response.page!=undefined){x2CreateContactDialog.empty();$("body").off("click","#Contact_assignedTo_groupCheckbox");x2CreateContactDialog.append(response.page);x2CreateContactDialog.find(".formSectionHide").remove();x2CreateContactDialog.find(".create-account").remove();submit=x2CreateContactDialog.find('input[type="submit"]');form=x2CreateContactDialog.find("form");$(submit).click(function(){return x2CreateContactDialogHandleSubmit(form)})}}}});return false}$.fn.initCreateOpportunityDialog=function(createOpportunityUrl,modelName,modelId,accountName,assignedTo,tooltip){$(this).data("createOpportunityUrl",createOpportunityUrl);$(this).data("modelName",modelName);$(this).data("modelId",modelId);$(this).data("account-name",accountName);$(this).data("assigned-to",assignedTo);$(this).qtip({content:tooltip});if(x2CreateOpportunityDialog!=null){return}x2CreateOpportunityDialog=$("<div></div>",{id:"x2-create-opportunity-dialog"});x2CreateOpportunityDialog.dialog({title:"Create Opportunity",autoOpen:false,resizable:true,width:"650px",show:"fade",hide:"fade"});x2CreateOpportunityDialog.data("inactive",true);$(this).click(function(){if($(this).data("createOpportunityUrl")!=undefined){if(x2CreateOpportunityDialog.data("inactive")){$.post($(this).data("createOpportunityUrl"),{x2ajax:true},function(response){x2CreateOpportunityDialog.append(response);x2CreateOpportunityDialog.dialog("open");x2CreateOpportunityDialog.data("inactive",false);x2CreateOpportunityDialog.find(".formSectionHide").remove();submit=x2CreateOpportunityDialog.find('input[type="submit"]');form=x2CreateOpportunityDialog.find("form");$(submit).click(function(){var formdata=form.serializeArray();var x2ajax={};x2ajax.name="x2ajax";x2ajax.value="1";var modelName={};modelName.name="ModelName";modelName.value=$("#create-opportunity").data("modelName");var modelId={};modelId.name="ModelId";modelId.value=$("#create-opportunity").data("modelId");formdata.push(x2ajax);formdata.push(modelName);formdata.push(modelId);$.post($("#create-opportunity").data("createOpportunityUrl"),formdata,function(response){response=$.parseJSON(response);if(response.status=="success"){$.fn.yiiGridView.update("opportunities-grid");x2CreateOpportunityDialog.dialog("close");x2CreateOpportunityDialog.empty();$("body").off("click","#Opportunity_assignedTo_groupCheckbox");x2CreateOpportunityDialog.data("inactive",true);if($("#relationships-form").is(":hidden")){toggleRelationshipsForm()}}});return false});if($("#create-opportunity").data("account-name")!=undefined){$("#Opportunity_accountName").val($("#create-opportunity").data("account-name"))}if($("#create-opportunity").data("assigned-to")!=undefined){$("#Opportunity_assignedTo_assignedToDropdown").val($("#create-opportunity").data("assigned-to"))}})}else{x2CreateOpportunityDialog.dialog("open")}}});return $(this)};$.fn.initCreateCaseDialog=function(createCaseUrl,modelName,modelId,contactName,assignedTo,tooltip){$(this).data("createCaseUrl",createCaseUrl);$(this).data("modelName",modelName);$(this).data("modelId",modelId);$(this).data("contact-name",contactName);$(this).data("assigned-to",assignedTo);$(this).qtip({content:tooltip});if(x2CreateCaseDialog!=null){return}x2CreateCaseDialog=$("<div></div>",{id:"x2-create-opportunity-dialog"});x2CreateCaseDialog.dialog({title:"Create Case",autoOpen:false,resizable:true,width:"650px",show:"fade",hide:"fade"});x2CreateCaseDialog.data("inactive",true);$(this).click(function(){if($(this).data("createCaseUrl")!=undefined){if(x2CreateCaseDialog.data("inactive")){$.post($(this).data("createCaseUrl"),{x2ajax:true},function(response){x2CreateCaseDialog.append(response);x2CreateCaseDialog.dialog("open");x2CreateCaseDialog.data("inactive",false);x2CreateCaseDialog.find(".formSectionHide").remove();submit=x2CreateCaseDialog.find('input[type="submit"]');form=x2CreateCaseDialog.find("form");$(submit).click(function(){return x2CreateCaseDialogHandleSubmit(form)});if($("#create-case").data("contact-name")!=undefined){$("#Services_contactId").val($("#create-case").data("contact-name"))}if($("#create-case").data("assigned-to")!=undefined){$("#Services_assignedTo_assignedToDropdown").val($("#create-case").data("assigned-to"))}})}else{x2CreateCaseDialog.dialog("open")}}});return $(this)};function x2CreateCaseDialogHandleSubmit(form){var formdata=form.serializeArray();var x2ajax={};x2ajax.name="x2ajax";x2ajax.value="1";var modelName={};modelName.name="ModelName";modelName.value=$("#create-case").data("modelName");var modelId={};modelId.name="ModelId";modelId.value=$("#create-case").data("modelId");formdata.push(x2ajax);formdata.push(modelName);formdata.push(modelId);$.post($("#create-case").data("createCaseUrl"),formdata,function(response){response=$.parseJSON(response);if(response.status=="success"){$.fn.yiiGridView.update("opportunities-grid");x2CreateCaseDialog.dialog("close");x2CreateCaseDialog.empty();$("body").off("click","#Services_assignedTo_groupCheckbox");x2CreateCaseDialog.data("inactive",true);if($("#relationships-form").is(":hidden")){toggleRelationshipsForm()}}else{if(response.status=="userError"){if(response.page!=undefined){x2CreateCaseDialog.empty();$("body").off("click","#Services_assignedTo_groupCheckbox");x2CreateCaseDialog.append(response.page);x2CreateCaseDialog.find(".formSectionHide").remove();submit=x2CreateCaseDialog.find('input[type="submit"]');form=x2CreateCaseDialog.find("form");$(submit).click(function(){return x2CreateCaseDialogHandleSubmit(form)})}}}});return false}$.fn.initCreateAccountDialog2=function(createAccountUrl,modelName,modelId,accountName,assignedTo,phone,website,tooltip){$(this).data("createAccountUrl",createAccountUrl);$(this).data("modelName",modelName);$(this).data("modelId",modelId);$(this).data("account-name",accountName);$(this).data("assigned-to",assignedTo);$(this).data("phone",phone);$(this).data("website",website);$(this).qtip({content:tooltip});if(x2CreateAccountDialog!=null){return}x2CreateAccountDialog=$("<div></div>",{id:"x2-create-action-dialog"});x2CreateAccountDialog.dialog({title:"Create Account",autoOpen:false,resizable:true,width:"650px",show:"fade",hide:"fade"});x2CreateAccountDialog.data("inactive",true);$(this).click(function(){if($(this).data("createAccountUrl")!=undefined){if(x2CreateAccountDialog.data("inactive")){$.post($(this).data("createAccountUrl"),{x2ajax:true},function(response){x2CreateAccountDialog.append(response);x2CreateAccountDialog.dialog("open");x2CreateAccountDialog.data("inactive",false);x2CreateAccountDialog.find(".formSectionHide").remove();submit=x2CreateAccountDialog.find('input[type="submit"]');form=x2CreateAccountDialog.find("form");$(submit).click(function(){return x2CreateAccountDialogHandleSubmit(form)});if($("#create-account").data("phone")!=undefined){$("#Accounts_phone").val($("#create-account").data("phone"))}if($("#create-account").data("website")!=undefined){$("#Accounts_website").val($("#create-account").data("website"))}if($("#create-account").data("assigned-to")!=undefined){$("#Accounts_assignedTo_assignedToDropdown").val($("#create-account").data("assigned-to"))}})}else{x2CreateAccountDialog.dialog("open")}}});return $(this)};function x2CreateAccountDialogHandleSubmit(form){var formdata=form.serializeArray();var x2ajax={};x2ajax.name="x2ajax";x2ajax.value="1";var modelName={};modelName.name="ModelName";modelName.value=$("#create-account").data("modelName");var modelId={};modelId.name="ModelId";modelId.value=$("#create-account").data("modelId");formdata.push(x2ajax);formdata.push(modelName);formdata.push(modelId);$.post($("#create-account").data("createAccountUrl"),formdata,function(response){response=$.parseJSON(response);if(response.status=="success"){$.fn.yiiGridView.update("opportunities-grid");x2CreateAccountDialog.dialog("close");x2CreateAccountDialog.empty();$("body").off("click","#Accounts_assignedTo_groupCheckbox");x2CreateAccountDialog.data("inactive",true);showRelationships=true;if(response.primaryAccountLink!=undefined){if(response.primaryAccountLink!=""){$("#Contacts_company_field div.formInputBox").html(response.primaryAccountLink);$("#Opportunity_accountName_field div.formInputBox").html(response.primaryAccountLink);showRelationships=false}}if(response.newPhone!=undefined){if(response.newPhone!=""){$("#Contacts_phone_field div.formInputBox").html(response.newPhone)}}if(response.newWebsite!=undefined){if(response.newWebsite!=""){$("#Contacts_website_field div.formInputBox").html(response.newWebsite)}}if($("#relationships-form").is(":hidden")&&showRelationships){toggleRelationshipsForm()}}else{if(response.status=="userError"){if(response.page!=undefined){x2CreateAccountDialog.empty();$("body").off("click","#Accounts_assignedTo_groupCheckbox");x2CreateAccountDialog.append(response.page);x2CreateAccountDialog.find(".formSectionHide").remove();submit=x2CreateAccountDialog.find('input[type="submit"]');form=x2CreateAccountDialog.find("form");$(submit).click(function(){return x2CreateAccountDialogHandleSubmit(form)})}}}});return false}function toggleRelationshipsForm(){if($("#relationships-form").is(":hidden")){$(".focus-mini-module").removeClass("focus-mini-module");$("#relationships-form").children(".form").addClass("focus-mini-module")}$("#relationships-form").animate({opacity:"toggle",height:"toggle"},300)}function tabSelected(event,ui){$("#SelectedTab").val(ui.panel.id);if(ui.panel.id=="new-event"){$("#due-date-label").css("display","none");$("#start-date-label").css("display","block");$("#end-date-label").css("display","block");$("#end-date-input").css("display","inline-block");$("#action-event-panel").css("display","block")}else{if(ui.panel.id=="new-action"){$("#due-date-label").css("display","block");$("#start-date-label").css("display","none");$("#end-date-label").css("display","none");$("#end-date-input").css("display","none");$("#action-event-panel").css("display","block")}else{if(ui.panel.id=="log-a-call"){$("#action-event-panel").css("display","none")}else{if(ui.panel.id=="new-comment"){$("#action-event-panel").css("display","none")}}}}}function sanityCheck(){}function publisherUpdates(){if($("#calendar").length!==0){$("#calendar").fullCalendar("refetchEvents")}if($(".list-view").length!==0){$.fn.yiiListView.update($(".list-view").attr("id"))}}function resetPublisher(){if($("#groupCheckbox").is(":checked")){$("#groupCheckbox").click()}$("#publisher-form select, #publisher-form input[type=text], #publisher-form textarea").each(function(i){$(this).val($(this).data("defaultValue"))});$("#publisher-form input[type=checkbox]").each(function(i){$(this).attr("checked",$(this).data("defaultValue"))});$("#save-publisher").removeClass("highlight")}var textsize;function initTags(){$("#x2-inline-tags").droppable({accept:".x2-tag",activeClass:"x2-state-active",hoverClass:"x2-state-hover",drop:function(event,ui){$("#x2-tag-list").appendTag(ui.draggable.context)}});$("#x2-inline-tags-filter").droppable({accept:".x2-tag",activeClass:"x2-state-active",hoverClass:"x2-state-hover",drop:function(event,ui){if($("#x2-tag-list-filter").text()==$("#x2-tag-list-filter").attr("title")){$("#x2-tag-list-filter").html("")}$("#x2-tag-list-filter").appendTagFilter(ui.draggable.context);$(".link-disable a").click(function(e){e.preventDefault()})}});$("#publisher-form #tabs").droppable({accept:".x2-tag",drop:function(event,ui){$("#Actions_actionDescription").val($("#Actions_actionDescription").val()+" "+ui.draggable.context.innerHTML)}});$(".delete-tag").click(function(event){return removeHandler(event)});$(".filter").click(function(event){return removeHandlerFilter(event)});$(".link-disable a").click(function(e){e.preventDefault()});unlockCreateTag();$("#x2-inline-tags").click(function(event){return createNewTagHandler(event)});$(".tag a").click(function(event){event.stopPropagation()});textsize=$("<div>");$("body").append(textsize);textsize.css({position:"absolute",visibility:"hidden",height:"auto",width:"auto"})}$.fn.appendTag=function(tag){$(this).each(function(){var span=$("<span>",{"class":"tag"});var parent=$(this);$.post($("#x2-inline-tags").data("appendTagUrl"),{Type:$("#x2-inline-tags").data("type"),Id:$("#x2-inline-tags").data("id"),Tag:tag.innerHTML},function(response){if(eval(response)==true){parent.append(span);span.hide().appendRemove().appendTagLink(tag).fadeIn("slow")}})});return $(this)};$.fn.appendTagFilter=function(tag){$(this).each(function(){var span=$("<span>",{"class":"tag link-disable"});var parent=$(this);parent.append(span);span.hide().appendRemoveFilter().appendTagLink(tag).fadeIn("slow")});return $(this)};$.fn.appendTagLink=function(tag){$(this).each(function(){var link=$("<a>",{href:tag.href,html:tag.innerHTML});$(this).append(link);link.click(function(event){return(tagLinkClickHandler(event))})});return $(this)};function tagLinkClickHandler(event){event.stopPropagation()}$.fn.appendRemove=function(){$(this).each(function(){var remove=$("<span>",{"class":"delete-tag",html:"[x] "});$(this).append(remove);remove.click(function(event){return(removeHandler(event))})});return $(this)};$.fn.appendRemoveFilter=function(){$(this).each(function(){var remove=$("<span>",{"class":"delete-tag filter",html:"[x] "});$(this).append(remove);remove.click(function(event){return(removeHandlerFilter(event))})});return $(this)};function removeHandler(event){var remove=$(event.target);var tag=remove.next("a");tag=tag[0];var parent=remove.parent();var width=parent.width();if(parent.children("input").length>0){parent.fadeOut(function(){parent.empty().remove()});unlockCreateTag();return false}$.post($("#x2-inline-tags").data("removeTagUrl"),{Type:$("#x2-inline-tags").data("type"),Id:$("#x2-inline-tags").data("id"),Tag:tag.innerHTML},function(response){if(eval(response)==true){parent.animate({opacity:0},function(){parent.css("width",width+"px");parent.empty();parent.animate({width:"toggle"},function(){$(this).remove()})})}});return false}function removeHandlerFilter(event){var remove=$(event.target);var tag=remove.next("a");tag=tag[0];var parent=remove.parent();var width=parent.width();if(parent.children("input").length>0){parent.fadeOut(function(){parent.empty().remove()});unlockCreateTag();return false}parent.animate({opacity:0},function(){parent.css("width",width+"px");parent.empty();parent.animate({width:"toggle"},function(){$(this).remove()})});return false}function createNewTagHandler(event){if(creatingNewTag()==false){lockCreateTag();var span=$("<span>",{"class":"tag",});var textfield=$('<input type="text">',{"class":"x2-new-tag",value:"#",});$("#x2-tag-list").append(span);span.hide().appendRemove().appendTagInput().fadeIn("slow");span.children("input").focus()}}$.fn.appendTagInput=function(){$(this).each(function(){var tagtext=$('<input type="text">',{"class":"x2-new-tag",value:"#",});var parent=$(this);parent.append(tagtext);tagtext.bind("keydown",function(event){return(tagKeyHandler(event,parent,tagtext))});tagtext.bind("keypress paste",function(event){if($.browser.msie){if(parseInt($.browser.version)<9){tagKeyHandler(event,parent,tagtext)}}$(this).resizeTag()});tagtext.blur(function(){parent.fadeOut(function(){parent.empty().remove()});unlockCreateTag()})});return $(this)};function tagKeyHandler(event,span,textfield){textfield.qtip({content:"key="+$.browser.ie});if(event.which==13){if(textfield.val()==""||textfield.val()=="#"){span.fadeOut(function(){span.empty().remove()});unlockCreateTag()}else{var value=textfield.val();value=value.replace(/#/g,"");value="#"+value;$.post($("#x2-inline-tags").data("appendTagUrl"),{Type:$("#x2-inline-tags").data("type"),Id:$("#x2-inline-tags").data("id"),Tag:value},function(response){var link=$("<a>",{href:$("#x2-inline-tags").data("searchUrl")+"?term="+value.replace(/#/g,"%23"),html:value,});textfield.remove();span.append(link);link.click(function(e){e.stopPropagation()})});unlockCreateTag()}}else{textfield.resizeTag()}}$.fn.resizeTag=function(){$(this).each(function(){textsize.html($(this).val());$(this).css("width",(textsize.width()+10)+"px")});return $(this)};function lockCreateTag(){$("#x2-inline-tags").data("new-tag-active",true)}function unlockCreateTag(){$("#x2-inline-tags").data("new-tag-active",false)}function creatingNewTag(){return $("#x2-inline-tags").data("new-tag-active")}$(function(){var $inputs=$("input, button, textarea").filter(function(){return $(this).attr("value").match(/<dt class="yii-t">.+/)});var $options=$("option").filter(function(){return $(this).text().match(/<dt class="yii-t">.+/)});$.each($inputs,function(i,elem){var translation=$(".yiiTranslationList").append($(elem).attr("value")+"<br>").find("dt").last().text();$(elem).attr("value",translation)});$.each($options,function(i,elem){var translation=$(".yiiTranslationList").append($(elem).text()+"<br>").find("dt").last().text();$(elem).text(translation)});var altKeyDown=false;$("body").mousemove(function(e){if(e.altKey!=altKeyDown){$(this).toggleClass("yii-t",e.altKey)}altKeyDown=e.altKey});$(document).delegate("dt.yii-t","click",function(e){if(e.altKey){e.preventDefault();e.stopPropagation();var category=$(this).find("input#cat").val();var message=$(this).find("input#msg").val();alert(category+", "+message);return false}return true})});$(function(){$("#content-widgets").droppable({accept:".x2-widget-menu-item",activeClass:"x2-state-active",hoverClass:"x2-state-hover",drop:function(event,ui){$.post($("body").data("showWidgetUrl"),{name:ui.draggable.attr("id"),block:"center",modelType:$("body").data("modelType"),modelId:$("body").data("modelId")},function(response){$("#"+ui.draggable.attr("id")).parent().remove();$("#content-widgets").append(response)})}});$("#content-widgets").sortable({update:function(event,ui){$.post($("body").data("reorderWidgetsUrl"),$(this).sortable("serialize")+"&block=center")}});$(".x2-widget-menu-item").draggable({revert:"invalid",helper:"clone",revertDuration:200,appendTo:"#widget-menu",iframeFix:true});$(".x2-widget-menu-item").click(function(){return handleWidgetMenuItemClick($(this))});$(".x2-widget-menu-item.widget-right").click(function(){return handleWidgetRightMenuItemClick($(this))})});function handleWidgetMenuItemClick(menuItem){$.post($("body").data("showWidgetUrl"),{name:menuItem.attr("id"),block:"center",modelType:$("body").data("modelType"),modelId:$("body").data("modelId")},function(response){$("#"+menuItem.attr("id")).parent().remove();if($("#widget-menu > :first-child").hasClass("x2widget-menu-divider")){$("#widget-menu > :first-child").remove()}else{if($("#widget-menu > :last-child").hasClass("x2widget-menu-divider")){$("#widget-menu > :last-child").remove()}}$("#content-widgets").prepend(response);$.post($("body").data("reorderWidgetsUrl"),$("#content-widgets").sortable("serialize")+"&block=center")});return true}$.fn.hideWidget=function(){$(this).each(function(){var widget=$(this);var widgetName=$(this).attr("id").slice(9);$.post($("body").data("hideWidgetUrl"),{name:widgetName},function(response){widget.slideUp(function(){widget.remove();$("#widget-menu").replaceWith(response);$(".x2-widget-menu-item").click(function(){return handleWidgetMenuItemClick($(this))});$(".x2-widget-menu-item.widget-right").click(function(){return handleWidgetRightMenuItemClick($(this))})})})})};function handleWidgetRightMenuItemClick(menuItem){$.post($("body").data("showWidgetUrl"),{name:menuItem.attr("id"),block:"right",},function(response){window.location.reload(true)});return true}$.fn.hideWidgetRight=function(){$(this).each(function(){var widget=$(this);var widgetName=$(this).attr("id").slice(7);$.post($("body").data("hideWidgetUrl"),{name:widgetName},function(response){widget.slideUp(function(){widget.remove();$("#widget-menu").replaceWith(response);$(".x2-widget-menu-item").click(function(){return handleWidgetMenuItemClick($(this))});$(".x2-widget-menu-item.widget-right").click(function(){return handleWidgetRightMenuItemClick($(this))});if($("#sidebar-right .portlet").length==0&&window.fullscreen==false){$("#fullscreen-button").trigger("click")}})})})};$.fn.minimizeWidget=function(){$(this).each(function(){var widget=$(this);var widgetName=$(this).attr("id").slice(9);var min=widget.find(".x2widget-container").is(":hidden")==false;$.post($("body").data("minimizeWidgetUrl"),{name:widgetName,minimize:min},function(response){if(min==true){widget.find(".x2widget-container").slideUp();widget.find(".x2widget-minimize").html("[+]")}else{widget.find(".x2widget-container").slideDown();widget.find(".x2widget-minimize").html("[&ndash;]")}})})};$(function(){$("div.x2-layout .formSectionShow, .formSectionHide").click(function(){toggleFormSection($(this).closest(".formSection"));saveFormSections()});$("a#showAll, a#hideAll").click(function(){$("a#showAll, a#hideAll").toggleClass("hide");if($("#showAll").hasClass("hide")){$("div.x2-layout .formSection:not(.showSection)").each(function(){if($(this).find("a.formSectionHide").length>0){toggleFormSection(this)}})}else{$("div.x2-layout .formSection.showSection").each(function(){if($(this).find("a.formSectionHide").length>0){toggleFormSection(this)}})}});$(".inlineLabel").find("input:text, textarea").focus(function(){formFieldFocus(this)}).blur(function(){formFieldBlur(this)});$(".x2-hint").qtip();$(".x2-info").qtip()});function toggleFormSection(section){if($(section).hasClass("showSection")){$(section).find(".tableWrapper").slideToggle(400,function(){$(this).parent(".formSection").toggleClass("showSection");saveFormSections()})}else{$(section).toggleClass("showSection").find(".tableWrapper").slideToggle(400);saveFormSections()}}function saveFormSections(){var formSectionStatus=[];$("div.x2-layout .formSection").each(function(i,section){formSectionStatus[i]=$(section).hasClass("showSection")?"1":"0"});var formSettings="["+formSectionStatus.join(",")+"]";$.ajax({url:yii.scriptUrl+"/site/saveFormSettings",type:"GET",data:"formName="+window.formName+"&formSettings="+encodeURI(formSettings)})}function toggleText(field){if(field.defaultValue==field.value){field.value="";field.style.color="black"}else{if(field.value==""){field.value=field.defaultValue;field.style.color="#aaa"}}}function formFieldFocus(elem){var field=$(elem);if(field.val()==field.attr("title")){field.val("");field.css("color","#000")}}function formFieldBlur(elem){var field=$(elem);if(field.val()==""){field.val(field.attr("title"));field.css("color","#aaa")}}function submitForm(formName){document.forms[formName].submit()}function toggleForm(formName,duration){if($(formName).is(":hidden")){$("html,body").animate({scrollTop:($("#action-form").offset().top-200)},300)}$(formName).toggle("blind",{},duration)}function hide(field){$(field).hide();$("#save-changes").addClass("highlight")}function show(field){$(field).show()}function fileUpload(form,fileField,action_url,remove_url){var iframe=document.createElement("iframe");iframe.setAttribute("id","upload_iframe");iframe.setAttribute("name","upload_iframe");iframe.setAttribute("width","0");iframe.setAttribute("height","0");iframe.setAttribute("border","0");iframe.setAttribute("style","width: 0; height: 0; border: none;");form.parentNode.appendChild(iframe);window.frames.upload_iframe.name="upload_iframe";iframeId=document.getElementById("upload_iframe");var eventHandler=function(){if(iframeId.detachEvent){iframeId.detachEvent("onload",eventHandler)}else{iframeId.removeEventListener("load",eventHandler,false)}if(iframeId.contentDocument){var content=iframeId.contentDocument.body.innerHTML}else{if(iframeId.contentWindow){var content=iframeId.contentWindow.document.body.innerHTML}else{if(iframeId.document){var content=iframeId.document.body.innerHTML}}}var response=$.parseJSON(content);if(response.status=="success"){var file=$("<input>",{type:"hidden",name:"AttachmentFiles[id][]","class":"AttachmentFiles",value:response.id});var temp=$("<input>",{type:"hidden",name:"AttachmentFiles[temp][]",value:true});var parent=fileField.parent().parent().parent();parent.parent().find(".error").html("");var newFileChooser=parent.clone();parent.removeClass("next-attachment");parent.append(file);parent.append(temp);var remove=$("<a>",{href:"#",html:"[x]"});parent.find(".filename").html(response.name);parent.find(".remove").append(remove);remove.click(function(){removeAttachmentFile(remove.parent().parent(),remove_url);return false});fileField.parent().parent().remove();parent.after(newFileChooser);initX2FileInput()}else{fileField.parent().parent().parent().find(".error").html(response.message);fileField.val("")}setTimeout("iframeId.parentNode.removeChild(iframeId)",250)};if(iframeId.addEventListener){iframeId.addEventListener("load",eventHandler,true)}if(iframeId.attachEvent){iframeId.attachEvent("onload",eventHandler)}form.setAttribute("target","upload_iframe");form.setAttribute("action",action_url);form.setAttribute("method","post");form.setAttribute("enctype","multipart/form-data");form.setAttribute("encoding","multipart/form-data");form.submit()}function removeAttachmentFile(attachment,remove_url){var id=attachment.find(".AttachmentFiles");$.post(remove_url,{id:id.val()});attachment.remove()}function initX2FileInput(){$("input.x2-file-input[type=file]").hover(function(){var button=$("input.x2-file-input[type=file]").next();if(button.hasClass("active")==false){$("input.x2-file-input[type=file]").next().addClass("hover")}},function(){$("input.x2-file-input[type=file]").next().removeClass("hover")});$("input.x2-file-input[type=file]").mousedown(function(){$("input.x2-file-input[type=file]").next().removeClass("hover");$("input.x2-file-input[type=file]").next().addClass("active")});$("body").mouseup(function(){$("input.x2-file-input[type=file]").next().removeClass("active")});var chooseFileButtonCenter=parseInt($("input.x2-file-input[type=file]").css("width"),10)/2;var halfIconWidth=parseInt($("#choose-file-saving-icon").css("width"),10)/2;var iconLeft=chooseFileButtonCenter-halfIconWidth;$("#choose-file-saving-icon").css("left",iconLeft+"px");var chooseFileButtonCenter=parseInt($("input.x2-file-input[type=file]").css("height"),10)/2;var halfIconHeight=parseInt($("#choose-file-saving-icon").height(),10)/2;var iconTop=chooseFileButtonCenter-halfIconHeight;$("#choose-file-saving-icon").css("top",iconTop+"px")};